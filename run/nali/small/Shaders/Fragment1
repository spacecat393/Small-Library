#version 120
//precision highp float;

uniform sampler2D texture_sampler;

varying vec2 fragment_texcoord;
varying vec4 fragment_light_color;
varying vec3 fragment_normals;

void main()
{
    vec4 texture_color = texture2D(texture_sampler, fragment_texcoord);

    if (texture_color.a == 0.0 || fragment_light_color.a == 0.0)
    {
        discard;
    }

    vec3 light_dir = normalize(gl_LightSource[0].position.xyz);
    float diffuse = max(dot(fragment_normals, light_dir), 0.0);

    vec3 rgb_color = texture_color.rgb;
    if (diffuse < 0.5)
    {
        rgb_color *= 0.9;
    }

    gl_FragColor = vec4(rgb_color * fragment_light_color.rgb, texture_color.a * fragment_light_color.a);
}
